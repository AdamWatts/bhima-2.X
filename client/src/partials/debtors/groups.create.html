<div class="container-fluid"> 
  <div class="row">
    <div class="col-xs-12">
      <uib-alert type="danger" ng-show="GroupCreateCtrl.exception">
        <span class="glyphicon glyphicon-exclamation-sign"></span>
        <b>{{GroupCreateCtrl.exception.data.code | translate }}</b> {{GroupCreateCtrl.exception.data.description}}
      </uib-alert>
    </div>
  </div>
  <div class="row">
    <div class="col-xs-12">
      <p><a ng-href="#/debtors/groups">
        <span class="glyphicon glyphicon-circle-arrow-left"></span>
        Back to Debtor Groups
      </a></p>
    </div>
  </div>
  
  <div class="row">
    <div class="col-md-5">
      
      <form name="debtorGroup" class="form">
        
        <!-- <fieldset> -->
          <!-- <legend>{{ "FORM.DETAILS" | translate }}</legend> -->
        <div 
          class="form-group has-feedback"
          ng-class="{'has-error' : debtorGroup.name.$invalid && debtorGroup.$submitted}">

                  
          <label class="control-label">{{ "COLUMNS.NAME" | translate }}</label>
          <input name="name" ng-model="GroupCreateCtrl.group.name" class="form-control" autocomplete="off" required> 

          <div class="help-block" ng-messages="debtorGroup.name.$error" ng-show="debtorGroup.$submitted">
            <div ng-messages-include="partials/templates/messages.tmpl.html"></div>
          </div>
        </div>
  
        <!-- @todo this should be a directive - this controller should not have to consider accounts -->
        <div 
          class="form-group has-feedback"
          ng-class="{'has-error' : debtorGroup.account.$invalid && debtorGroup.$submitted}">

          <label class="control-label">{{ "COLUMNS.ACCOUNT" | translate }}</label>
          <input
            class="form-control"
            name="account"
            placeholder="{{ 'PLACEHOLDERS.ENTER.ACCOUNT' | translate }}..."
            uib-typeahead="account as account.hrlabel for account in GroupCtrl.accounts | filter:$viewValue | limitTo:10"
            typeahead-template-url="partials/templates/typeahead/accounts.html"
            ng-model="GroupCreateCtrl.group.account"
            autocomplete="off"
            autocorrect="off"
            autocapitalize="off"
            required>

          <div class="help-block" ng-messages="debtorGroup.account.$error" ng-show="debtorGroup.$submitted">
            <div ng-messages-include="partials/templates/messages.tmpl.html"></div>
          </div>
        </div>
        
        <div 
          class="form-group has-feedback"
          ng-class="{'has-error' : debtorGroup.priceList.$invalid && debtorGroup.$submitted}">
          
          <label class="control-label">{{ "COLUMNS.PRICE_LIST" | translate }}</label>
          <select 
            name="priceList" 
            ng-model="GroupCreateCtrl.group.priceList" 
            ng-options="priceList.uuid as priceList.label for priceList in GroupCtrl.priceLists" 
            class="form-control" 
            required>
            <option value="" disabled="disabled">{{ "PLACEHOLDERS.SELECT.PRICE_LIST" | translate }}</option>
          </select>
          
          <div class="help-block" ng-messages="debtorGroup.priceList.$error" ng-show="debtorGroup.$submitted">
            <div ng-messages-include="partials/templates/messages.tmpl.html"></div>
          </div>
        </div>
       
        <div 
          class="form-group has-feedback"
          ng-class="{'has-error' : debtorGroup.maxCredit.$invalid && debtorGroup.$submitted}">
          
          <label class="control-label">{{ "COLUMNS.MAX_CREDIT" | translate }}</label>
          <p class="text-info"><span class="glyphicon glyphicon-info-sign"></span> The maximum credit value this debtor group can collect before being warned. A value of 0 means no maximum limit.</p>
          <input type="number" ng-model="GroupCreateCtrl.group.maxCredit" name="maxCredit" class="form-control" autocomplete="off" bh-integer required> 

          <div class="help-block" ng-messages="debtorGroup.maxCredit.$error" ng-show="debtorGroup.$submitted">
            <div ng-messages-include="partials/templates/messages.tmpl.html"></div>
          </div>
        </div>

        <div class="form-group">
          <label class="control-label">{{ "COLUMNS.NOTE" | translate }}</label>
          <textarea class="form-control" ng-model="GroupCreateCtrl.group.notes" autocomplete="off" name="notes"></textarea>
        </div>
        <!-- </fieldset> -->
        
        <!-- <fieldset> -->
          <!-- <legend>Contact</legend> -->

                
          <div class="form-group">
            <label class="control-label">{{ "COLUMNS.PHONE" | translate }}</label>
            <input name="phone" ng-model="GroupCreateCtrl.group.phone" autocomplete="off" class="form-control">
          </div>

          <div class="form-group">
            <label class="control-label">{{ "COLUMNS.EMAIL" | translate }}</label>
            <input name="email" ng-model="GroupCreateCtrl.group.email" type="email" autocomplete="off" class="form-control">
          </div>
      
          <div class="form-group">
            <!-- <label class="control-label">{{ "COLUMNS.EMAIL" | translate }}</label> -->
            <!-- <input name="email" type="email" class="form-control"> -->
            <bh-location-select 
              id="location"
              validation-trigger="debtorGroup.$submitted"
              location-uuid="GroupCreateCtrl.group.location"
              required></bh-location-select>
          </div>

        <!-- </fieldset> -->
      </form>
    
      <!-- @todo remove temporary style hack -->
      <div class="clearfix" style="margin-bottom : 5px">
        <div class="pull-right">

          <!-- @todo remove temporary style hack -->
          <div class="checkbox" style="display : inline-block; padding-right : 5px;">
            <label>
              <input type="checkbox">
              Create another debtor group
            </label>
          </div>

          <!-- <button class="btn btn-default btn-sm">Cancel</button> -->
          <button ng-click="GroupCreateCtrl.submit(debtorGroup)" class="btn btn-primary btn-sm">Submit</button>
        </div>
      </div>
    </div>

    <div class="col-md-7">
      
      <hr class="visible-sm"></hr>
      
      <div class="panel panel-default">
        <div class="panel-heading">
          <span class="glyphicon glyphicon-book"></span> 
          Group Policies
        </div>
        <div class="panel panel-body">
          <!-- Billing Services -->
          <div class="row">
            <div class="col-md-12">
              <h5><b>Subsidies</b></h5>

              <!-- Only show if the subsidies option is unchecked -->
              <p ng-if="GroupCreateCtrl.group.policies.subsidies===false" class="text-info">
                <span class="glyphicon glyphicon-info-sign"></span> With this configuration unchecked no member of this debtor group will qualify for any subsidies
              </p> 
              <div class="checkbox">
                <label>
                  <input ng-model="GroupCreateCtrl.group.policies.subsidies" type="checkbox">
                  This group qualifies for subsidies 
                </label>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col-md-12">
              <h5><b>Discounts</b></h5>
              <p ng-if="GroupCreateCtrl.group.policies.discounts===false" class="text-info">
                <span class="glyphicon glyphicon-info-sign"></span> With this configuration unchecked no member of this debtor group will qualify for any discounts
              </p> 
              
              <div class="checkbox">
                <label>
                  <input ng-model="GroupCreateCtrl.group.policies.discounts" type="checkbox">
                  This group qualifies for discounts 
                </label>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col-md-12">
              <h5><b>Billing Services</b></h5>
              <p ng-if="GroupCreateCtrl.group.policies.billingServices===true" class="text-info">
                <span class="glyphicon glyphicon-info-sign"></span> With this configuration option checked all members of this debtor group will be exempt from paying automatically applied billing services
              </p> 

              <div class="checkbox">
                <label>
                  <input ng-model="GroupCreateCtrl.group.policies.billingServices" type="checkbox">
                  This group is exmempt from paying billing services 
                </label>
              </div>
            </div>
          </div>
          
          <!-- These operations should be hidden for a new account -->
          <div class="row">
            <div class="col-md-12">
              <!-- @todo -->
              <!-- Placeholder - these features are not yet supported in 2.x -->
              <!--
              <hr>
              
              <button class="btn btn-default">
                <span class="glyphicon glyphicon-lock"></span>
                Lock Debtor Group
              </button> 
      
              <button class="btn btn-danger"><span class="glyphicon glyphicon-trash"></span> Delete Debtor Group</button> 
              -->
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
